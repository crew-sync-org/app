modules:
  # 1. The "Pit Wall" (Project Dashboard)
  jira:projectPage:
    - key: crewsync-pit-wall
      resource: mainAppResource
      resolver:
        function: resolver
      render: native
      title: CrewSync 
      icon: assets/logo.png

  # 2. The "Driver's View" (Issue Panel)
  jira:issuePanel:
    - key: crewsync-issue-panel
      resource: mainAppResource
      resolver:
        function: resolver
      render: native
      title: CrewSync Analysis
      icon: assets/logo.png

  # 3. The "Configuration" (Settings)
  jira:projectSettingsPage:
    - key: crewsync-settings-page
      resource: mainAppResource
      resolver:
        function: resolver
      render: native
      title: CrewSync Config

  # 4. The "Watchdog" (Background Process)
  trigger:
    - key: on-issue-created
      function: autoScanner
      events:
        - avi:jira:created:issue

    - key: on-issue-updated
      function: autoScanner
      events:
        - avi:jira:updated:issue


  # 5. Function Registry
  function:
    - key: resolver
   
      handler: resolvers/index.handler
    - key: autoScanner
      
      handler: resolvers/triggers.handler

# Unified Resource Definition
resources:
  - key: mainAppResource
    path: src/frontend/index.jsx

app:
  runtime:
    name: nodejs22.x
  id: ari:cloud:ecosystem::app/399a28d6-73b6-4e8b-8c58-1662e37d660f

permissions:
  scopes:
    - read:jira-work
    - write:jira-work
    - manage:jira-project
    - storage:app
    - read:jira-user
  content:
    styles:
      - unsafe-inline
  external:
    fetch:
      backend:
        - address: bedrock-runtime.us-east-1.amazonaws.com
        - address: "*.amazonaws.com"